.cell-celebration-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 5; /* Above cell background, below content */
  overflow: hidden;
  border-radius: inherit; /* Match parent cell's rounding */
}

/* 1. Micro-lift (applied to the button itself) */
.cell-celebrating {
  animation: micro-lift 1.1s ease-out forwards;
}
@keyframes micro-lift {
  0% { transform: scale(0.98); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
  7.2% { transform: scale(1); box-shadow: 0 4px 12px rgba(0,0,0,0.15); } /* 80ms */
  100% { transform: scale(1); box-shadow: none; }
}

/* 2. Border Wrap */
.cell-celebration-overlay::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border: 2px solid transparent;
  border-radius: inherit;
  
  /* Gradient that will be revealed by the mask */
  background: linear-gradient(135deg, #29FFC6, #46A6FF, #B721FF, #46A6FF, #29FFC6);
  background-size: 300% 300%;
  animation: gradient-pan 3s linear infinite, border-wrap 1.1s ease-out forwards;

  /* Mask to "draw" the border */
  mask: conic-gradient(from 90deg at 1px 1px, #0000 90deg, #000 0) 
        0 0 / calc(100% - 2px) calc(100% - 2px) round;
  -webkit-mask: conic-gradient(from 90deg at 1px 1px, #0000 90deg, #000 0) 
        0 0 / calc(100% - 2px) calc(100% - 2px) round;
}

@keyframes gradient-pan {
  0% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes border-wrap {
  0%, 7.2% { opacity: 0; } /* Start after lift */
  7.3% { opacity: 0.28; }
  27.2% { opacity: 0.12; } /* Settle to 12% after 220ms wrap */
  90% { opacity: 0.12; }
  100% { opacity: 0; }
}

/* 3. Diagonal Shimmer */
.cell-celebration-overlay::after {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    -15deg,
    transparent 40%,
    rgba(255, 255, 255, 0.12) 48%,
    rgba(255, 255, 255, 0.12) 52%,
    transparent 60%
  );
  transform: translateX(-100%);
  animation: diagonal-shimmer 1.1s ease-out forwards;
}

@keyframes diagonal-shimmer {
  0%, 25.4% { transform: translateX(-100%); } /* Start after wrap (280ms) */
  52.7% { transform: translateX(100%); } /* Shimmer over 300ms */
  100% { transform: translateX(100%); }
}

/* Accessibility: Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  .cell-celebrating {
    animation: none; /* No lift */
  }
  .cell-celebration-overlay::after {
    animation: none; /* No shimmer */
  }
  .cell-celebration-overlay::before {
    /* Static border highlight */
    animation: border-highlight-reduced 1.1s ease-out forwards;
  }
  @keyframes border-highlight-reduced {
    0% { opacity: 0; }
    5% { opacity: 0.14; }
    40% { opacity: 0.14; } /* Hold for 400ms */
    100% { opacity: 0; }
  }
}
